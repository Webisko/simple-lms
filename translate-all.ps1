# Comprehensive Polish to English translation dictionary
$translations = @{
    # Security & Auth
    'Nieprawidłowy token bezpieczeństwa' = 'Invalid security token'
    'Musisz być zalogowany' = 'You must be logged in'
    'Nie masz uprawnień do duplikowania lessons in this course\.' = 'You do not have permission to duplicate lessons in this course.'
    'Nie można zduplikować lekcji bez MODULE nadrzędnego\.' = 'Cannot duplicate lesson without parent module.'
    'Nie masz uprawnień do usunięcia tej lekcji' = 'You do not have permission to delete this lesson'
    'Nie udało się usunąć lekcji' = 'Failed to delete lesson'
    'Nieprawidłowy identyfikator MODULE' = 'Invalid module ID'
    'Nieprawidłowy identyfikator lekcji' = 'Invalid lesson ID'
    'Nie masz uprawnień do duplikowania MODULE w tym kursie\.' = 'You do not have permission to duplicate modules in this course.'
    'Nie można zduplikować MODULE bez kursu nadrzędnego\.' = 'Cannot duplicate module without parent course.'
    'Nie masz uprawnień do usunięcia tego MODULE' = 'You do not have permission to delete this module'
    'Nie udało się usunąć MODULE' = 'Failed to delete module'
    'Nie udało się zaktualizować kolejności' = 'Failed to update order'
    'Nie udało się zmienić statusu' = 'Failed to change status'
    
    # Validation messages
    'Nieprawidłowy identyfikator kursu' = 'Invalid course ID'
    'Nieprawidłowy identyfikator modułu' = 'Invalid module ID'
    'Nieprawidłowe ID kursu' = 'Invalid course ID'
    'Nieprawidłowe ID modułu' = 'Invalid module ID'
    'Nieprawidłowe ID lekcji' = 'Invalid lesson ID'
    'Wymagany tytuł' = 'Title required'
    'Tytuł jest wymagany' = 'Title is required'
    
    # Widget error messages
    'Nie można wykryć kursu\. Upewnij się, że widget jest używany na stronie kursu\.' = 'Cannot detect course. Make sure widget is used on a course page.'
    'Nie można wykryć kursu\. Upewnij się, że widget jest używany na stronie kursu lub ustaw ID kursu ręcznie\.' = 'Cannot detect course. Make sure widget is used on a course page or set course ID manually.'
    'Nie można wykryć poprawnego kursu\. Upewnij się, że widget jest używany na stronie kursu/modułu/lekcji albo ustaw prawidłowy ID\.' = 'Cannot detect valid course. Make sure widget is used on course/module/lesson page or set valid ID.'
    'Nie można wykryć poprawnego kursu\. Upewnij się, że widget jest używany na stronie kursu lub lekcji albo ustaw prawidłowy ID\.' = 'Cannot detect valid course. Make sure widget is used on course or lesson page or set valid ID.'
    'Nie można wykryć poprawnego kursu\. Upewnij się, że widget jest używany na stronie kursu albo ustaw prawidłowy ID\.' = 'Cannot detect valid course. Make sure widget is used on course page or set valid ID.'
    'Nie można wykryć lekcji\. Upewnij się, że widget jest używany na stronie lekcji\.' = 'Cannot detect lesson. Make sure widget is used on lesson page.'
    'Nie można wykryć poprawnej lekcji\. Upewnij się, że widget jest używany na stronie lekcji albo ustaw prawidłowy ID\.' = 'Cannot detect valid lesson. Make sure widget is used on lesson page or set valid ID.'
    'Ten widget działa tylko na stronach kursów, modułów lub lekcji\.' = 'This widget only works on course, module or lesson pages.'
    'Użytkownik niezalogowany - przycisk będzie ukryty lub pokazywał "Zaloguj się"' = 'User not logged in - button will be hidden or show "Log in"'
    
    # Frontend display
    'Ten kurs nie ma jeszcze modułów\.' = 'This course has no modules yet.'
    'Ten moduł nie ma jeszcze lekcji\.' = 'This module has no lessons yet.'
    'Przykładowy moduł 1' = 'Sample module 1'
    'Przykładowy moduł 2' = 'Sample module 2'
    '15 z 20 lekcji ukończonych' = '15 of 20 lessons completed'
    'Tytuł lekcji' = 'Lesson title'
    'Podgląd treści lekcji \(wyświetlane na stronie\)' = 'Lesson content preview (displayed on page)'
    'ukończone' = 'completed'
    
    # Course post type labels
    'Zobacz wszystkie kursy' = 'View all courses'
    'Filtruj listę kursów' = 'Filter courses list'
    'Strona kursu' = 'Course page'
    'Link stały kursu' = 'Course permalink'
    'Wyszukaj kurs' = 'Search course'
    'Zobacz kursy' = 'View courses'
    'Dodaj nowy kurs' = 'Add new course'
    'Zaktualizuj kurs' = 'Update course'
    
    # Module post type labels
    'Zobacz wszystkie moduły' = 'View all modules'
    'Filtruj listę modułów' = 'Filter modules list'
    'Strona modułu' = 'Module page'
    'Link stały modułu' = 'Module permalink'
    'Wyszukaj moduł' = 'Search module'
    'Zobacz moduły' = 'View modules'
    'Dodaj nowy moduł' = 'Add new module'
    'Zaktualizuj moduł' = 'Update module'
    
    # Lesson post type labels
    'Zobacz wszystkie lekcje' = 'View all lessons'
    'Filtruj listę lekcji' = 'Filter lessons list'
    'Strona lekcji' = 'Lesson page'
    'Link stały lekcji' = 'Lesson permalink'
    'Wyszukaj lekcję' = 'Search lesson'
    'Zobacz lekcje' = 'View lessons'
    'Dodaj nową lekcję' = 'Add new lesson'
    'Zaktualizuj lekcję' = 'Update lesson'
    
    # Progress tracker
    'Postęp w kursie' = 'Course progress'
    'Rozpoczęto' = 'Started'
    'W trakcie' = 'In progress'
    'Ukończony' = 'Completed'
    'godz\.' = 'hr.'
    'min\.' = 'min.'
    'sek\.' = 'sec.'
    
    # Asset Manager
    'Plik nie istnieje' = 'File does not exist'
    'Błąd odczytu pliku' = 'File read error'
    'Niewspierany typ pliku' = 'Unsupported file type'
    'Plik jest za duży' = 'File is too large'
    'Nieprawidłowa ścieżka pliku' = 'Invalid file path'
    'Plik został pomyślnie przesłany' = 'File successfully uploaded'
    
    # Access Control
    'Kurs niedostępny' = 'Course unavailable'
    'Moduł niedostępny' = 'Module unavailable'
    'Lekcja niedostępna' = 'Lesson unavailable'
    'Dostęp zablokowany' = 'Access blocked'
    'Wymaga zakupu' = 'Purchase required'
}

Write-Host "Starting mass translation..." -ForegroundColor Cyan
$totalFiles = 0
$totalReplacements = 0

Get-ChildItem -Path includes -Filter *.php -Recurse | ForEach-Object {
    $file = $_
    $changed = $false
    $fileReplacements = 0
    
    try {
        $content = Get-Content -Path $file.FullName -Raw -Encoding UTF8
        $originalContent = $content
        
        foreach ($key in $translations.Keys) {
            $pattern = [regex]::Escape($key)
            if ($content -match $pattern) {
                $matches = ([regex]::Matches($content, $pattern)).Count
                $content = $content -replace $pattern, $translations[$key]
                $fileReplacements += $matches
                $changed = $true
            }
        }
        
        if ($changed) {
            Set-Content -Path $file.FullName -Value $content -Encoding UTF8 -NoNewline
            $totalFiles++
            $totalReplacements += $fileReplacements
            Write-Host "  ✓ $($file.Name): $fileReplacements replacements" -ForegroundColor Green
        }
    }
    catch {
        Write-Host "  ✗ Error in $($file.Name): $_" -ForegroundColor Red
    }
}

Write-Host "`n✅ Translation completed!" -ForegroundColor Green
Write-Host "   Files updated: $totalFiles" -ForegroundColor Yellow
Write-Host "   Total replacements: $totalReplacements" -ForegroundColor Yellow
